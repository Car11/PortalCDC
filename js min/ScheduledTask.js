var id="NULL",arrayOfThisfile=[],arrayOffiles=[];$(document).ready(function(){});function encode_Files(){$("#inputFileToLoad").change(function(){arrayOffiles=[];var a=document.getElementById("inputFileToLoad").files;if(0<a.length)for(var b=0;b<document.getElementById("inputFileToLoad").files.length;b+=1)getBase64(a[b])})}function getBase64(a){arrayOfThisfile=[];var b=new FileReader;b.readAsDataURL(a),b.onload=function(c){arrayOfThisfile=[],$("dataExt",{src:c.target.result,title:a.name}),arrayOfThisfile.push(a.name),arrayOfThisfile.push(c.target.result),arrayOffiles.push(arrayOfThisfile)},b.onerror=function(c){console.log("Error: ",c)}}function loadProjectsByUser(a){var b=JSON.parse(a);$.each(b,function(c,d){var g="<option value="+d.id+">"+d.name+"</option>";$(".list").append(g)})}function EventoClickEliminar(){id=$(this).parents("tr").find("td").eq(0).text(),swal({title:"Eliminar esta tarea programada?",text:"Esta acci\xF3n es irreversible!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, cancelar!",confirmButtonClass:"btn btn-success",cancelButtonClass:"btn btn-danger",closeOnConfirm:!1,closeOnCancel:!1},function(a){a?(Eliminar(id),swal("Borrada!","La tarea programada ha sido eliminada.","success")):swal("Cancelled","Your imaginary file is safe :)","error")})}function Eliminar(a){alert(a),$.ajax({type:"POST",url:"class/ScheduledTask.php",data:{action:"Delete",idScheduledTask:a}})}function New(){id="NULL",$(".modal").css({display:"block"})}function SaveScheduledTask(){if(!FormValidate())return!1;var b,c,a="NULL"==id?"Insert":"Update";b=document.getElementById("chkDow").checked?"t":$("#dow").val(),c=document.getElementById("chkDom").checked?"t":$("#dom").val(),varSubTask=document.getElementById("chkSubTask").checked?"1":"0";var d=[];if($("table#dataTable tr").each(function(){var o=$(this).find("td"),p=o[2].firstElementChild.value;d.push(p)}),0<arrayOffiles.length){for(var g=0;g<arrayOffiles.length;g++){var h=arrayOffiles[g][1],j=h.split(";"),k=j[0].split(":")[1],l=j[1].split(",")[1];arrayOffiles[g][1]=l}var m="1"}else var m="0";$.ajax({type:"POST",url:"class/ScheduledTask.php",data:{action:a,projectid:$("#projectid").val(),title:$("#title").val(),description:$("#description").val(),minute:$("#minute").val(),hour:$("#hour").val(),dom:c,year:$("#year").val(),subtask_des:JSON.stringify(d),subTask:varSubTask,file:m,objFile:JSON.stringify(arrayOffiles),dow:b}}).done(function(n){alert(n),$("#title").val(""),$("#description").val(""),$("#minute").val("00"),$("#hour").val("00"),$("#year").val("2017"),$("#dow").val("Todos")}).fail(showError)}function Check_SubTask_Status(){var a=document.getElementById("btnAdd");a.disabled=!a.disabled;var b=document.getElementById("btnDel");b.disabled=!b.disabled;var c=document.getElementById("chk");c.disabled=!c.disabled;var c=document.getElementById("subtask");c.disabled=!c.disabled}function addRow(a){var b=document.getElementById(a),c=b.rows.length,d=b.insertRow(c),g=d.insertCell(0),h=document.createElement("input");h.type="checkbox",h.name="chkbox[]",g.appendChild(h);var j=d.insertCell(1);Count=c+1,j.innerHTML="<span style='color:#ddd;'>"+Count+"</span>";var k=d.insertCell(2),l=document.createElement("input");l.type="text",l.name="txtbox[]",l.className=" sub-task-desc",k.appendChild(l)}function deleteRow(a){try{for(var b=document.getElementById(a),c=b.rows.length,d=0;d<c;d++){var g=b.rows[d],h=g.cells[0].childNodes[0];null!=h&&!0==h.checked&&(b.deleteRow(d),c--,d--)}}catch(j){alert(j)}}function FormValidate(){if(""==$("#title").val())return $("#title").css("border","0.3px solid firebrick"),document.getElementById("title").placeholder="REQUERIDO",$("#title").focus(),!1;if(5>$("#title").val().length)return $("#title").css("border","0.3px solid firebrick"),showError("T\xEDtulo: M\xEDnimo 5 digitos sin guiones ni espacios"),!1;if(""==$("#description").val())return $("#description").css("border","0.3px solid firebrick"),document.getElementById("description").placeholder="REQUERIDO",$("#description").focus(),!1;if(5>$("#description").val().length)return $("#description").css("border","0.3px solid firebrick"),showError("La descripci\xF3n debe tener m\xEDnimo 5 caracteres"),!1;var a=$("#description").val();return CadenaSinEspacios=a.trim(),document.getElementById("description").value=CadenaSinEspacios,!0}function showInfo(){}function showError(){}