var id="NULL",arrayOfThisfile=[],arrayOffiles=[];$(document).ready(function(){});function encode_Files(){$("#inputFileToLoad").change(function(){arrayOffiles=[];var e=document.getElementById("inputFileToLoad").files;if(e.length>0)for(var t=0;t<document.getElementById("inputFileToLoad").files.length;t+=1)getBase64(e[t])})}function getBase64(e){arrayOfThisfile=[];var t=new FileReader;t.readAsDataURL(e),t.onload=function(t){arrayOfThisfile=[],$("dataExt",{src:t.target.result,title:e.name}),arrayOfThisfile.push(e.name),arrayOfThisfile.push(t.target.result),arrayOffiles.push(arrayOfThisfile)},t.onerror=function(e){console.log("Error: ",e)}}function loadProjectsByUser(e){var t=JSON.parse(e);$.each(t,function(e,t){var a="<option value="+t.id+">"+t.name+"</option>";$(".list").append(a)})}function EventoClickEliminar(){id=$(this).parents("tr").find("td").eq(0).text(),swal({title:"Eliminar esta tarea programada?",text:"Esta acción es irreversible!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, cancelar!",confirmButtonClass:"btn btn-success",cancelButtonClass:"btn btn-danger",closeOnConfirm:!1,closeOnCancel:!1},function(e){e?(Eliminar(id),swal("Borrada!","La tarea programada ha sido eliminada.","success")):swal("Cancelled","Your imaginary file is safe :)","error")})}function Eliminar(e){alert(e),$.ajax({type:"POST",url:"class/ScheduledTask.php",data:{action:"Delete",idScheduledTask:e}})}function New(){id="NULL",$(".modal").css({display:"block"})}function SaveScheduledTask(){if(!FormValidate())return!1;var e,t,a="NULL"==id?"Insert":"Update";e=document.getElementById("chkDow").checked?"t":$("#dow").val(),t=document.getElementById("chkDom").checked?"t":$("#dom").val(),document.getElementById("chkSubTask").checked?varSubTask="1":varSubTask="0";var i=[];if($("table#dataTable tr").each(function(){var e=$(this).find("td")[2].firstElementChild.value;i.push(e)}),arrayOffiles.length>0){for(var n=0;n<arrayOffiles.length;n++){var r=arrayOffiles[n][1].split(";"),l=(r[0].split(":")[1],r[1].split(",")[1]);arrayOffiles[n][1]=l}var o="1"}else o="0";$.ajax({type:"POST",url:"class/ScheduledTask.php",data:{action:a,projectid:$("#projectid").val(),title:$("#title").val(),description:$("#description").val(),minute:$("#minute").val(),hour:$("#hour").val(),dom:t,year:$("#year").val(),subtask_des:JSON.stringify(i),subTask:varSubTask,file:o,objFile:JSON.stringify(arrayOffiles),dow:e}}).done(function(e){alert(e),$("#title").val(""),$("#description").val(""),$("#minute").val("00"),$("#hour").val("00"),$("#year").val("2017"),$("#dow").val("Todos")}).fail(showError)}function Check_SubTask_Status(){var e=document.getElementById("btnAdd");e.disabled=!e.disabled;var t=document.getElementById("btnDel");t.disabled=!t.disabled;(a=document.getElementById("chk")).disabled=!a.disabled;var a;(a=document.getElementById("subtask")).disabled=!a.disabled}function addRow(e){var t=document.getElementById(e),a=t.rows.length,i=t.insertRow(a),n=i.insertCell(0),r=document.createElement("input");r.type="checkbox",r.name="chkbox[]",n.appendChild(r);var l=i.insertCell(1);Count=a+1,l.innerHTML="<span style='color:#ddd;'>"+Count+"</span>";var o=i.insertCell(2),s=document.createElement("input");s.type="text",s.name="txtbox[]",s.className=" sub-task-desc",o.appendChild(s)}function deleteRow(e){try{for(var t=document.getElementById(e),a=t.rows.length,i=0;i<a;i++){var n=t.rows[i].cells[0].childNodes[0];null!=n&&1==n.checked&&(t.deleteRow(i),a--,i--)}}catch(e){alert(e)}}function FormValidate(){if(""==$("#title").val())return $("#title").css("border","0.3px solid firebrick"),document.getElementById("title").placeholder="REQUERIDO",$("#title").focus(),!1;if($("#title").val().length<5)return $("#title").css("border","0.3px solid firebrick"),showError("Título: Mínimo 5 digitos sin guiones ni espacios"),!1;if(""==$("#description").val())return $("#description").css("border","0.3px solid firebrick"),document.getElementById("description").placeholder="REQUERIDO",$("#description").focus(),!1;if($("#description").val().length<5)return $("#description").css("border","0.3px solid firebrick"),showError("La descripción debe tener mínimo 5 caracteres"),!1;var e=$("#description").val();return CadenaSinEspacios=e.trim(),document.getElementById("description").value=CadenaSinEspacios,!0}function showInfo(){}function showError(){}