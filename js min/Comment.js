class Comment{constructor(t,n,e,a,o,i,s,m,l,c){this.id=t||null,this.taskId=n||null,this.userId=e||null,this.username=a||"",this.name=o||"",this.comment=i||"",this.reference=s||"",this.dateCreation=m||null,this.dateModification=l||null,this.hasComments=c||!1}get LoadbyTask(){$.ajax({type:"POST",url:"class/Comment.php",data:{action:"LoadbyTask",taskId:this.taskId}}).done(function(t){ShowComments(t)}).fail(function(t){showError(t)})}get Load(){$.ajax({type:"POST",url:"class/Comment.php",data:{action:"Load",id:this.id}}).done(function(t){JSON.parse(t)[0]}).fail(function(t){showError(t)})}get Save(){$("#btnSaveComment").attr("disabled","disabled");var t=null==this.id?"Insert":"Update";this.comment=$("#newComment").val(),this.comment=this.comment.replace(/\n/g,"<br>"),this.comment=this.comment.replace(/\r/g,"<br>"),$.ajax({type:"POST",url:"class/Comment.php",data:{action:t,obj:JSON.stringify(this)}}).done(function(){ReloadComments()}).fail(function(t){showError(t)}).always(function(){$("#newComment").val(""),setTimeout('$("#btnSaveComment").removeAttr("disabled")',1500),comment=new Comment})}get Delete(){$.ajax({type:"POST",url:"class/Comment.php",data:{action:"Delete",obj:JSON.stringify(this)}}).done(function(){swal({type:"success",title:"Eliminado!",showConfirmButton:!1,timer:1500})}).fail(function(t){showError(t)}).always(function(){comment=new Comment,ReloadComments()})}}let comment=new Comment;$(document).ready(function(){});function ShowComments(t){$("#commentBox").html("");var n=JSON.parse(t);$.each(n,function(t,n){$("#hascomments").css("display","inline");var e=n.name.split(" ");e=e[0].substring(0,1)+e[1].substring(0,1);Date(1e3*n.date_creation);$("#commentBox").append(`\n            <div class="comment" id="comment${n.id}" value= ${n.id} > \n                <div class="avatar avatar-left"> \n                    <div class="avatar-letter" style="background-color: rgb(154, 108, 224)" title="${n.name}">${e}</div> \n                </div>\n                <div class="comment-title"> \n                    <strong class="comment-username"> ${n.name} </strong> \n                    <small class="comment-date">Creado en: ${moment(1e3*n.date_creation).format("MMMM Do YYYY, h:mm")}</small>\n                    <small class="comment-date">Actualizado: ${moment(1e3*n.date_modification).fromNow()}</small>\n                </div>\n\n                <div class="comment-actions">\n                    <div class="dropdown">\n                        <a href="#" class="dropdown-menu dropdown-menu-link-icon"><i class="fa fa-cog"></i><i class="glyphicon glyphicon-cog"></i></a>\n                        <ul>\n                            \x3c!-- <li>\n                                <a href="/kanboard/?controller=CommentController&amp;action=edit&amp;task_id=5071&amp;project_id=20&amp;comment_id=83" class="js-modal-medium" title=""><i class="fa fa-edit fa-fw js-modal-medium" aria-hidden="true"></i>Modificar</a>\n                            </li> --\x3e\n                            <li id="delete${n.id}" value="${n.id}" >\n                                <a class="js-modal-confirm" ><i class="glyphicon glyphicon-trash" aria-hidden="true"></i>Suprimir</a>\n                            </li>\n                        </ul>\n                    </div>\n                </div>\n                \n                <div class="comment-content"> <div class="markdown"> <p> ${n.comment} </p> </div>\n            </div>\n        `),$(`#delete${n.id}`).click(function(t){comment.id=$(this).attr("value"),DeleteEventHandler()})})}function DeleteEventHandler(){swal({title:"Eliminar?",text:"Esta acciÃ³n es irreversible!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, cancelar!",confirmButtonClass:"btn btn-success",cancelButtonClass:"btn btn-danger"}).then(t=>{t.value&&comment.Delete})}function ReloadComments(){comment.taskId=id,comment.LoadbyTask}